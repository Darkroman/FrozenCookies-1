function setOverrides(){_.keys(FrozenCookies.preferenceValues).forEach(function(e){FrozenCookies[e]=preferenceParse(e,FrozenCookies.preferenceValues[e].default)}),logEvent("Load","Initial Load of Frozen Cookies v "+FrozenCookies.branch+"."+FrozenCookies.version+". (You should only ever see this once.)"),FrozenCookies.frequency=100,FrozenCookies.efficiencyWeight=1,FrozenCookies.cookieClickSpeed=preferenceParse("cookieClickSpeed",0),FrozenCookies.frenzyClickSpeed=preferenceParse("frenzyClickSpeed",0),FrozenCookies.HCAscendAmount=preferenceParse("HCAscendAmount",0),FrozenCookies.minCpSMult=preferenceParse("minCpSMult",1),FrozenCookies.cursorMax=preferenceParse("cursorMax",500),FrozenCookies.farmMax=preferenceParse("farmMax",500),FrozenCookies.manaMax=preferenceParse("manaMax",100),FrozenCookies.maxSpecials=preferenceParse("maxSpecials",1),FrozenCookies.timeTravelAmount=0,FrozenCookies.autobuyCount=0,FrozenCookies.frenzyTimes=JSON.parse(localStorage.getItem("frenzyTimes"))||{},FrozenCookies.lastHCAmount=Number(localStorage.getItem("lastHCAmount")),FrozenCookies.lastHCTime=Number(localStorage.getItem("lastHCTime")),FrozenCookies.prevLastHCTime=Number(localStorage.getItem("prevLastHCTime")),FrozenCookies.maxHCPercent=Number(localStorage.getItem("maxHCPercent")),FrozenCookies.hc_gain=0,FrozenCookies.hc_gain_time=Date.now(),FrozenCookies.last_gc_state=(Game.hasBuff("Frenzy")?Game.buffs.Frenzy.multCpS:1)*clickBuffBonus(),FrozenCookies.last_gc_time=Date.now(),FrozenCookies.lastCPS=Game.cookiesPs,FrozenCookies.lastBaseCPS=Game.cookiesPs,FrozenCookies.lastCookieCPS=0,FrozenCookies.lastUpgradeCount=0,FrozenCookies.currentBank={cost:0,efficiency:0},FrozenCookies.targetBank={cost:0,efficiency:0},FrozenCookies.disabledPopups=!0,FrozenCookies.trackedStats=[],FrozenCookies.lastGraphDraw=0,FrozenCookies.calculatedCpsByType={},FrozenCookies.processing=!1,FrozenCookies.priceReductionTest=!1,FrozenCookies.cookieBot=0,FrozenCookies.autoclickBot=0,FrozenCookies.autoFrenzyBot=0,FrozenCookies.frenzyClickBot=0,FrozenCookies.smartTrackingBot=0,FrozenCookies.minDelay=1e4,FrozenCookies.delayPurchaseCount=0,FrozenCookies.recalculateCaches=!0,FrozenCookies.caches={},FrozenCookies.caches.nextPurchase={},FrozenCookies.caches.recommendationList=[],FrozenCookies.caches.buildings=[],FrozenCookies.caches.upgrades=[],blacklist[FrozenCookies.blacklist]||(FrozenCookies.blacklist=0),Beautify=fcBeautify,Game.sayTime=function(e,o){return timeDisplay(e/Game.fps)},Game.oldReset=Game.Reset,Game.oldWriteSave=Game.WriteSave,Game.oldLoadSave=Game.LoadSave,Game.Reset=fcReset,Game.WriteSave=fcWriteSave,Game.Win=fcWin,Game.oldBackground=Game.DrawBackground,Game.DrawBackground=function(){Game.oldBackground(),updateTimers()},nextPurchase(!0),Game.RefreshStore(),Game.RebuildUpgrades(),beautifyUpgradesAndAchievements(),eval("Game.shimmerTypes.golden.popFunc = "+Game.shimmerTypes.golden.popFunc.toString().replace(/Game\.Popup\((.+)\)\;/g,'logEvent("GC", $1, true);')),eval("Game.UpdateWrinklers = "+Game.UpdateWrinklers.toString().replace(/Game\.Popup\((.+)\)\;/g,'logEvent("Wrinkler", $1, true);')),eval("FrozenCookies.safeGainsCalc = "+Game.CalculateGains.toString().replace(/eggMult\+=\(1.+/,"eggMult++; // CENTURY EGGS SUCK").replace(/Game\.cookiesPs/g,"FrozenCookies.calculatedCps").replace(/Game\.globalCpsMult/g,"mult")),Game.HasAchiev("Third-party")||Game.Win("Third-party")}function preferenceParse(e,o){var a=localStorage.getItem(e);return(void 0===a||null==a||isNaN(Number(a)))&&(a=o,localStorage.setItem(e,a)),Number(a)}function scientificNotation(e){return 0===e||!Number.isFinite(e)||Math.abs(e)>=1&&Math.abs(e)<=1e3?rawFormatter(e):e=(e=(e=parseFloat(e)).toExponential(2)).replace("+","")}!function(e){var o=e.isFinite;Object.defineProperty(Number,"isFinite",{value:function(e){return"number"==typeof e&&o(e)},configurable:!0,enumerable:!1,writable:!0})}(this);var numberFormatters=[rawFormatter,formatEveryThirdPower([""," million"," billion"," trillion"," quadrillion"," quintillion"," sextillion"," septillion"," octillion"," nonillion"," decillion"," undecillion"," duodecillion"," tredecillion"," quattuordecillion"," quindecillion"," sexdecillion"," septendecillion"," octodecillion"," novemdecillion"," vigintillion"," unvigintillion"," duovigintillion"," trevigintillion"," quattuorvigintillion"," quinvigintillion"," sexvigintillion"," septenvigintillion"," octovigintillion"," novemvigintillion"," trigintillion"," untrigintillion"," duotrigintillion"," tretrigintillion"," quattuortrigintillion"," quintrigintillion"," sextrigintillion"," septentrigintillion"," octotrigintillion"," novemtrigintillion"]),formatEveryThirdPower([""," M"," B"," T"," Qa"," Qi"," Sx"," Sp"," Oc"," No"," De"," UnD"," DoD"," TrD"," QaD"," QiD"," SxD"," SpD"," OcD"," NoD"," Vg"," UnV"," DoV"," TrV"," QaV"," QiV"," SxV"," SpV"," OcV"," NoV"," Tg"," UnT"," DoT"," TrT"," QaT"," QiT"," SxT"," SpT"," OcT"," NoT"]),formatEveryThirdPower([""," M"," G"," T"," P"," E"," Z"," Y"]),scientificNotation];function fcBeautify(e){var o=e<0;e=Math.abs(e);var a=(0,numberFormatters[FrozenCookies.numberDisplay])(e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");return o?"-"+a:a}function beautifyUpgradesAndAchievements(){function e(e){return Beautify(parseInt(e.replace(/,/,""),10))}var o=/\d\d?\d?(?:,\d\d\d)*/;Game.AchievementsById.forEach(function(a){a.desc=a.desc.replace(o,e)}),Game.UpgradesById.forEach(function(a){a.desc=a.desc.replace(o,e)})}function timeDisplay(e){return"---"===e||0===e?"Done!":e==Number.POSITIVE_INFINITY?"Never!":(e=Math.floor(e),o=(o=Math.floor(e/86400))>0?Beautify(o)+"d ":"",e%=86400,a=Math.floor(e/3600),e%=3600,(o+(a=a>0?a+"h ":"")+(n=(n=Math.floor(e/60))>0?n+"m ":"")+(e=(e%=60)>0?e+"s":"")).trim());var o,a,n}function fcReset(){Game.CollectWrinklers(),Game.HasUnlocked("Chocolate egg")&&!Game.Has("Chocolate egg")&&(Game.ObjectsById.forEach(function(e){e.sell(-1)}),Game.Upgrades["Chocolate egg"].buy()),Game.oldReset(),FrozenCookies.frenzyTimes={},FrozenCookies.last_gc_state=(Game.hasBuff("Frenzy")?Game.buffs.Frenzy.multCpS:1)*clickBuffBonus(),FrozenCookies.last_gc_time=Date.now(),FrozenCookies.lastHCAmount=Game.HowMuchPrestige(Game.cookiesEarned+Game.cookiesReset+wrinklerValue()),FrozenCookies.lastHCTime=Date.now(),FrozenCookies.maxHCPercent=0,FrozenCookies.prevLastHCTime=Date.now(),FrozenCookies.lastCps=0,FrozenCookies.lastBaseCps=0,FrozenCookies.trackedStats=[],updateLocalStorage(),recommendationList(!0)}function fcWriteSave(e){return Game.oldWriteSave(e)}function updateLocalStorage(){_.keys(FrozenCookies.preferenceValues).forEach(function(e){localStorage[e]=FrozenCookies[e]}),localStorage.frenzyClickSpeed=FrozenCookies.frenzyClickSpeed,localStorage.cookieClickSpeed=FrozenCookies.cookieClickSpeed,localStorage.HCAscendAmount=FrozenCookies.HCAscendAmount,localStorage.cursorMax=FrozenCookies.cursorMax,localStorage.farmMax=FrozenCookies.farmMax,localStorage.minCpSMult=FrozenCookies.minCpSMult,localStorage.frenzyTimes=JSON.stringify(FrozenCookies.frenzyTimes),localStorage.lastHCAmount=FrozenCookies.lastHCAmount,localStorage.maxHCPercent=FrozenCookies.maxHCPercent,localStorage.lastHCTime=FrozenCookies.lastHCTime,localStorage.manaMax=FrozenCookies.manaMax,localStorage.maxSpecials=FrozenCookies.maxSpecials,localStorage.prevLastHCTime=FrozenCookies.prevLastHCTime}function divCps(e,o){var a=0;return e&&(a=o?e/o:Number.POSITIVE_INFINITY),a}function nextHC(e){var o=Math.ceil(Game.HowMuchPrestige(Game.cookiesEarned+Game.cookiesReset)),a=Game.HowManyCookiesReset(o)-(Game.cookiesEarned+Game.cookiesReset);return e?a:timeDisplay(divCps(a,Game.cookiesPs))}function copyToClipboard(e){Game.promptOn=1,window.prompt("Copy to clipboard: Ctrl+C, Enter",e),Game.promptOn=0}function getBuildingSpread(){return Game.ObjectsById.map(function(e){return e.amount}).join("/")}function writeFCButton(e){FrozenCookies[e]}function getSpeed(e){var o=prompt("How many times per second do you want to click? (Current maximum is 250 clicks per second)",e);return(void 0===o||null==o||isNaN(Number(o))||Number(o)<0||Number(o)>250)&&(o=e),Number(o)}function updateSpeed(e){var o=getSpeed(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getCpSMultMin(e){var o=prompt('What CpS multiplier should trigger Auto Casting (e.g. "7" will trigger when you have full mana and a Frenzy, "1" prevents triggering during a clot, etc.)?',e);return(void 0===o||null==o||isNaN(Number(o))||Number(o)<0)&&(o=e),Number(o)}function updateCpSMultMin(e){var o=getCpSMultMin(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getAscendAmount(e){var o=prompt("How many heavenly chips do you want to auto-ascend at?",0);return(void 0===o||null==o||isNaN(Number(o))||Number(o)<0)&&(o=0),Number(o)}function updateAscendAmount(e){var o=getAscendAmount(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getManaMax(e){var o=prompt("Set maximum mana: ",e);return(void 0===o||null==o||isNaN(Number(o))||Number(o<0))&&(o=e),Number(o)}function updateManaMax(e){var o=getManaMax(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getMaxSpecials(e){var o=prompt("Set amount of stacked Building specials for Harvest Bank: ",e);return(void 0===o||null==o||isNaN(Number(o))||Number(o<0))&&(o=e),Number(o)}function updateMaxSpecials(e){var o=getMaxSpecials(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getCursorMax(e){var o=prompt("How many Cursors should Autobuy stop at?",e);return(void 0===o||null==o||isNaN(Number(o))||Number(o<0))&&(o=e),Number(o)}function updateCursorMax(e){var o=getCursorMax(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function getFarmMax(e){var o=prompt("How many Farms should Autobuy stop at?",e);return(void 0===o||null==o||isNaN(Number(o))||Number(o<0))&&(o=e),Number(o)}function updateFarmMax(e){var o=getFarmMax(FrozenCookies[e]);o!=FrozenCookies[e]&&(FrozenCookies[e]=o,updateLocalStorage(),FCStart())}function updateTimeTravelAmount(){var e=prompt("Warning: Time travel is highly unstable, and large values are highly likely to either cause long delays or crash the game. Be careful!\nHow much do you want to time travel by? This will happen instantly.");(void 0===e||null===e||isNaN(Number(e))||Number(e)<0)&&(e=0),FrozenCookies.timeTravelAmount=e}function cyclePreference(e){var o=FrozenCookies.preferenceValues[e];if(o){var a=o.display,n=FrozenCookies[e],t=$("#"+e+"Button");if(a&&a.length>0&&t&&t.length>0){var i=(n+1)%a.length;t[0].innerText=a[i],FrozenCookies[e]=i,updateLocalStorage(),FrozenCookies.recalculateCaches=!0,Game.RefreshStore(),Game.RebuildUpgrades(),FCStart()}}}function toggleFrozen(e){Number(localStorage.getItem(e))?(localStorage.setItem(e,0),FrozenCookies[e]=0):(localStorage.setItem(e,1),FrozenCookies[e]=1),FCStart()}document.addEventListener("keydown",function(e){Game.promptOn||(65==e.keyCode&&(Game.Toggle("autoBuy","autobuyButton","Autobuy OFF","Autobuy ON"),toggleFrozen("autoBuy")),66==e.keyCode&&copyToClipboard(getBuildingSpread()),67==e.keyCode&&(Game.Toggle("autoGC","autogcButton","Autoclick GC OFF","Autoclick GC ON"),toggleFrozen("autoGC")),69==e.keyCode&&copyToClipboard(Game.WriteSave(!0)),82==e.keyCode&&Game.Reset(),83==e.keyCode&&Game.WriteSave(),87==e.keyCode&&Game.Notify("Wrinkler Info","Popping all wrinklers will give you "+Beautify(wrinklerValue())+' cookies. <input type="button" value="Click here to pop all wrinklers" onclick="Game.CollectWrinklers()"></input>',[19,8],7))});var T=Game.Objects.Temple.minigame,M=Game.Objects["Wizard tower"].minigame;function rigiSell(){Game.BuildingsOwned%10&&Game.Objects.Cursor.sell(Game.BuildingsOwned%10)}function lumpIn(e){Game.lumpT=Date.now()-Game.lumpRipeAge+6e4*e}function swapIn(e,o){if(0!=T.swaps){T.useSwap(1),T.lastSwapT=0;l("templeGod"+e);var a=T.slot[o];if(-1!=a){a=T.godsById[a];var n=l("templeGod"+a.id);if(-1!=T.godsById[e].slot)l("templeSlot"+T.godsById[e].slot).appendChild(n);else{var t=l("templeGodPlaceholder"+a.id);t.parentNode.insertBefore(n,t)}}l("templeSlot"+o).appendChild(l("templeGod"+e)),T.slotGod(T.godsById[e],o),PlaySound("snd/tick.mp3"),PlaySound("snd/spirit.mp3");var i=l("templeGod"+e).getBoundingClientRect();Game.SparkleAt((i.left+i.right)/2,(i.top+i.bottom)/2-24)}}function autoRigidel(){if(T){var e=(Game.lumpRipeAge-(Date.now()-Game.lumpT))/6e4;switch(Game.hasGod("order")?Game.hasGod("order"):0){case 0:if(T.swaps<2||1==T.swaps&&-1==T.slot[0])return;if(e<60){var o=T.slot[0];swapIn(10,0),Game.computeLumpTimes(),rigiSell(),Game.clickLump(),-1!=o&&swapIn(o,0)}case 1:e<60&&Game.BuildingsOwned%10&&(rigiSell(),Game.computeLumpTimes(),Game.clickLump());case 2:e<40&&Game.BuildingsOwned%10&&(rigiSell(),Game.computeLumpTimes(),Game.clickLump());case 3:e<20&&Game.BuildingsOwned%10&&(rigiSell(),Game.computeLumpTimes(),Game.clickLump())}}}function autoCast(){if(M&&M.magic==M.magicM)switch(FrozenCookies.autoSpell){case 0:return;case 1:var e=M.spellsById[0];if(M.magicM<Math.floor(e.costMin+e.costPercent*M.magicM))return;return void(cpsBonus()>=FrozenCookies.minCpSMult&&(M.castSpell(e),logEvent("AutoSpell","Cast Conjure Baked Goods")));case 2:var o=M.spellsById[1];if(M.magicM<Math.floor(o.costMin+o.costPercent*M.magicM))return;return void((cpsBonus()>=FrozenCookies.minCpSMult||Game.hasBuff("Dragonflight")||Game.hasBuff("Click frenzy"))&&(M.castSpell(o),logEvent("AutoSpell","Cast Force the Hand of Fate")));case 3:var a=M.spellsById[3];if(0==Game.Objects["Fractal engine"].amount||M.magicM<Math.floor(a.costMin+a.costPercent*M.magicM))return;for(;Game.Objects["Fractal engine"].amount>=400||Game.cookies<Game.Objects["Fractal engine"].price/2;)Game.Objects["Fractal engine"].sell(1),logEvent("Store","Sold 1 Fractal engine for "+Beautify(1.15*Game.Objects["Fractal engine"].price*.5));return M.castSpell(a),void logEvent("AutoSpell","Cast Spontaneous Edifice");case 4:var n=M.spellsById[4];if(M.magicM<Math.floor(n.costMin+n.costPercent*M.magicM))return;return M.castSpell(n),void logEvent("AutoSpell","Cast Haggler's Charm")}}function autoBlacklistOff(){switch(FrozenCookies.blacklist){case 1:FrozenCookies.blacklist=Game.cookiesEarned>=1e6?0:1;break;case 2:FrozenCookies.blacklist=Game.cookiesEarned>=1e9?0:2;break;case 3:FrozenCookies.blacklist=haveAll("halloween")&&haveAll("valentines")?0:3}}function getProbabilityList(e){return cumulativeProbabilityList[e][getProbabilityModifiers(e)]}function getProbabilityModifiers(e){var o;switch(e){case"golden":o=(Game.Has("Lucky day")?.5:1)*(Game.Has("Serendipity")?.5:1)*(Game.Has("Golden goose egg")?.95:1);break;case"reindeer":o=Game.Has("Reindeer baking grounds")?.5:1}return o}function cumulativeProbability(e,o,a){return 1-(1-getProbabilityList(e)[a])/(1-getProbabilityList(e)[o])}function probabilitySpan(e,o,a){var n=getProbabilityList(e)[o];return _.sortedIndex(getProbabilityList(e),n+a-n*a)}function clickBuffBonus(){var e=1;for(var o in Game.buffs)void 0!==Game.buffs[o].multClick&&"Devastation"!=Game.buffs[o].name&&(e*=Game.buffs[o].multClick);return e}function cpsBonus(){var e=1;for(var o in Game.buffs)void 0!==Game.buffs[o].multCpS&&(e*=Game.buffs[o].multCpS);return e}function hasClickBuff(){return Game.hasBuff("Cursed finger")||clickBuffBonus()>1}function baseCps(){var e=1;for(var o in Game.buffs)void 0!==Game.buffs[o].multCpS&&(e*=Game.buffs[o].multCpS);if(0===e)return FrozenCookies.lastBaseCPS;var a=Game.cookiesPs/e;return FrozenCookies.lastBaseCPS=a,a}function baseClickingCps(e){var o=clickBuffBonus(),a=Game.hasBuff("Frenzy")?Game.buffs.Frenzy.multCpS:1;return e*(Game.mouseCps()/(o*a))}function effectiveCps(e,o,a){o=null!=o?o:Game.elderWrath;var n=wrinklerMod(a=null!=a?a:o?10:0);return null==e&&(e=delayAmount()),baseCps()*n+gcPs(cookieValue(e,o,a))+baseClickingCps(FrozenCookies.cookieClickSpeed*FrozenCookies.autoClick)+reindeerCps(o)}function frenzyProbability(e){return e=null!=e?e:Game.elderWrath,cookieInfo.frenzy.odds[e]}function clotProbability(e){return e=null!=e?e:Game.elderWrath,cookieInfo.clot.odds[e]}function bloodProbability(e){return e=null!=e?e:Game.elderWrath,cookieInfo.blood.odds[e]}function cookieValue(e,o,a){var n=baseCps(),t=baseClickingCps(FrozenCookies.autoClick*FrozenCookies.cookieClickSpeed),i=FrozenCookies.autoFrenzy?baseClickingCps(FrozenCookies.autoFrenzy*FrozenCookies.frenzyClickSpeed):t,r=Game.Has("Get lucky")?2:1;o=null!=o?o:Game.elderWrath;var s=wrinklerMod(a=null!=a?a:o?10:0),c=0;return c-=cookieInfo.clot.odds[o]*(s*n+t)*r*66*.5,c+=cookieInfo.frenzy.odds[o]*(s*n+t)*r*77*6,c+=cookieInfo.blood.odds[o]*(s*n+t)*r*6*665,c+=cookieInfo.chain.odds[o]*calculateChainValue(e,n,7-o/3),c-=cookieInfo.ruin.odds[o]*(Math.min(.05*e,60*n*10)+13),c-=cookieInfo.frenzyRuin.odds[o]*(Math.min(.05*e,60*n*10*7)+13),c-=cookieInfo.clotRuin.odds[o]*(Math.min(.05*e,60*n*10*.5)+13),c+=cookieInfo.lucky.odds[o]*(Math.min(.15*e,60*n*15)+13),c+=cookieInfo.frenzyLucky.odds[o]*(Math.min(.15*e,60*n*15*7)+13),c+=cookieInfo.clotLucky.odds[o]*(Math.min(.15*e,60*n*15*.5)+13),c+=cookieInfo.click.odds[o]*i*r*13*777,c+=cookieInfo.frenzyClick.odds[o]*i*r*13*777*7,c+=cookieInfo.clotClick.odds[o]*i*r*13*777*.5,c+=0}function cookieStats(e,o,a){var n=baseCps(),t=baseClickingCps(FrozenCookies.autoClick*FrozenCookies.cookieClickSpeed),i=FrozenCookies.autoFrenzy?baseClickingCps(FrozenCookies.autoFrenzy*FrozenCookies.frenzyClickSpeed):t,r=Game.Has("Get lucky")?2:1;clickBuffBonus();o=null!=o?o:Game.elderWrath;var s=wrinklerMod(a=null!=a?a:o?10:0),c={};return c.clot=-1*cookieInfo.clot.odds[o]*(s*n+t)*r*66*.5,c.frenzy=cookieInfo.frenzy.odds[o]*(s*n+t)*r*77*7,c.blood=cookieInfo.blood.odds[o]*(s*n+t)*r*666*6,c.chain=cookieInfo.chain.odds[o]*calculateChainValue(e,n,7-o/3),c.ruin=-1*cookieInfo.ruin.odds[o]*(Math.min(.05*e,60*n*10)+13),c.frenzyRuin=-1*cookieInfo.frenzyRuin.odds[o]*(Math.min(.05*e,60*n*10*7)+13),c.clotRuin=-1*cookieInfo.clotRuin.odds[o]*(Math.min(.05*e,60*n*10*.5)+13),c.lucky=cookieInfo.lucky.odds[o]*(Math.min(.15*e,60*n*15)+13),c.frenzyLucky=cookieInfo.frenzyLucky.odds[o]*(Math.min(.15*e,60*n*15*7)+13),c.clotLucky=cookieInfo.clotLucky.odds[o]*(Math.min(.15*e,60*n*15*.5)+13),c.click=cookieInfo.click.odds[o]*i*r*13*777,c.frenzyClick=cookieInfo.frenzyClick.odds[o]*i*r*13*777*7,c.clotClick=cookieInfo.clotClick.odds[o]*i*r*13*777*.5,c.blah=0,c}function reindeerValue(e){var o=0;if("christmas"==Game.season){var a=1-(frenzyProbability(e)+clotProbability(e)+bloodProbability(e)),n=Game.Has("Ho ho ho-flavored frosting")?2:1;o+=Math.max(25,baseCps()*n*60*7)*frenzyProbability(e),o+=Math.max(25,baseCps()*n*60*.5)*clotProbability(e),o+=Math.max(25,baseCps()*n*60*666)*bloodProbability(e),o+=Math.max(25,baseCps()*n*60)*a}return o}function reindeerCps(e){var o=probabilitySpan("reindeer",0,.5)/Game.fps;return reindeerValue(e)/o*FrozenCookies.simulatedGCPercent}function calculateChainValue(e,o,a){return x=Math.min(e,60*o*60*6*4),n=Math.floor(Math.log(9*x/(4*a))/Math.LN10),125*Math.pow(9,n-3)*a}function chocolateValue(e,o){var a=0;if(Game.HasUnlocked("Chocolate egg")&&!Game.Has("Chocolate egg")){e=null!=e&&0!==e?e:Game.cookies;var n=.5,t=0;if(null==o)Game.hasAura("Earth Shatterer")&&(n=.85);else if(o&&(n=.85,!Game.hasAura("Earth Shatterer")))for(var i in Game.Objects)Game.Objects[i].amount>0&&(t=Game.Objects[i]);a=.05*(wrinklerValue()+e+Game.ObjectsById.reduce(function(e,o){return e+cumulativeBuildingCost(o.basePrice,1,(o==t?o.amount:o.amount+1)-o.free)*n},0))}return a}function wrinklerValue(){return Game.wrinklers.reduce(function(e,o){return e+popValue(o)},0)}function buildingRemaining(e,o){var a=cumulativeBuildingCost(e.basePrice,e.amount,o),n=Game.cookies+wrinklerValue()+Game.ObjectsById.reduce(function(o,a){return o+(a.name==e.name?0:cumulativeBuildingCost(a.basePrice,1,a.amount+1)/2)},0);return n*=Game.HasUnlocked("Chocolate egg")&&!Game.Has("Chocolate egg")?1.05:1,Math.max(0,a-n)}function earnedRemaining(e){return Math.max(0,e-(Game.cookiesEarned+wrinklerValue()+chocolateValue()))}function estimatedTimeRemaining(e){return timeDisplay(e/effectiveCps())}function canCastSE(){return M.magicM>=80&&Game.Objects["Fractal engine"].amount>0?1:0}function edificeBank(){if(!canCastSE)return 0;var e=Game.Objects["Fractal engine"].price;return Game.hasBuff("everything must go")?e*(100/95)/2:e/2}function luckyBank(){return 60*baseCps()*100}function luckyFrenzyBank(){return 60*baseCps()*100*7}function chainBank(){var e=7-Math.floor(Game.elderWrath/3);return 4*Math.floor(e/9*Math.pow(10,Math.floor(Math.log(194400*baseCps()/e)/Math.LN10)))}function harvestBank(){if(!FrozenCookies.setHarvestBankPlant)return 0;if(FrozenCookies.harvestMinutes=0,FrozenCookies.harvestMaxPercent=0,FrozenCookies.harvestFrenzy=1,FrozenCookies.harvestBuilding=1,FrozenCookies.harvestPlant="",1!=FrozenCookies.setHarvestBankType&&3!=FrozenCookies.setHarvestBankType||(FrozenCookies.harvestFrenzy=7),2==FrozenCookies.setHarvestBankType||3==FrozenCookies.setHarvestBankType){var e=[Game.Objects.Cursor.amount,Game.Objects.Grandma.amount,Game.Objects.Farm.amount,Game.Objects.Mine.amount,Game.Objects.Factory.amount,Game.Objects.Bank.amount,Game.Objects.Temple.amount,Game.Objects["Wizard tower"].amount,Game.Objects.Shipment.amount,Game.Objects["Alchemy lab"].amount,Game.Objects.Portal.amount,Game.Objects["Time machine"].amount,Game.Objects["Antimatter condenser"].amount,Game.Objects.Prism.amount,Game.Objects.Chancemaker.amount,Game.Objects["Fractal engine"].amount];e.sort(function(e,o){return o-e});for(var o=0;o<FrozenCookies.maxSpecials;o++)FrozenCookies.harvestBuilding*=e[o]}switch(FrozenCookies.setHarvestBankPlant){case 1:FrozenCookies.harvestPlant="Bakeberry",FrozenCookies.harvestMinutes=30,FrozenCookies.harvestMaxPercent=.03;break;case 2:FrozenCookies.harvestPlant="Chocoroot",FrozenCookies.harvestMinutes=3,FrozenCookies.harvestMaxPercent=.03;break;case 3:FrozenCookies.harvestPlant="White Chocoroot",FrozenCookies.harvestMinutes=3,FrozenCookies.harvestMaxPercent=.03;break;case 4:FrozenCookies.harvestPlant="Queenbeet",FrozenCookies.harvestMinutes=60,FrozenCookies.harvestMaxPercent=.04;break;case 5:FrozenCookies.harvestPlant="Duketater",FrozenCookies.harvestMinutes=120,FrozenCookies.harvestMaxPercent=.08;break;case 6:FrozenCookies.harvestPlant="Crumbspore",FrozenCookies.harvestMinutes=1,FrozenCookies.harvestMaxPercent=.01;break;case 7:FrozenCookies.harvestPlant="Doughshroom",FrozenCookies.harvestMinutes=5,FrozenCookies.harvestMaxPercent=.03}return 0==FrozenCookies.maxSpecials&&(FrozenCookies.maxSpecials=1),60*baseCps()*FrozenCookies.harvestMinutes*FrozenCookies.harvestFrenzy*FrozenCookies.harvestBuilding/Math.pow(10,FrozenCookies.maxSpecials)/FrozenCookies.harvestMaxPercent}function cookieEfficiency(e,o){var a=Number.MAX_VALUE,n=cookieValue(e),t=cookieValue(o);gcPs(t)>0?a=o<=e?0:divCps(Math.max(0,o-e),gcPs(t-n)):o<=e&&(a=0);return a}function bestBank(e){var o=3==FrozenCookies.autoSpell||FrozenCookies.holdSEBank?edificeBank():0,a=[0,luckyBank(),luckyFrenzyBank(),harvestBank()].sort(function(e,o){return o-e}).map(function(e){return{cost:e,efficiency:cookieEfficiency(Game.cookies,e)}}).filter(function(o){return o.efficiency>=0&&o.efficiency<=e||FrozenCookies.setHarvestBankPlant?o:null});return a[0].cost>o||FrozenCookies.setHarvestBankPlant?a[0]:{cost:o,efficiency:1}}function weightedCookieValue(e){var o=baseCps(),a=Game.Has("Get lucky"),n=a?401.835*o:396.51*o,t=a?2804.76*o:814.38*o;if(Game.cookiesEarned>=1e5){for(var i=1,r="6666",s=0,c=5;c<Math.min(Math.floor(Game.cookies).toString().length,12);c++)s+=.1*i*(r+="6"),i-=.1*i;t+=.0033*(s+=i*r),n+=.0595*s}return e&&Game.cookies<maxLuckyBank()&&(a?t-=.49*(900*o-Math.min(900*o,.15*Game.cookies))*.5+.49*(maxLuckyValue()-.15*Game.cookies)*.5:(t-=.49*(maxLuckyValue()-.15*Game.cookies),n-=.29*(maxLuckyValue()-.15*Game.cookies))),Game.elderWrath/3*n+(3-Game.elderWrath)/3*t}function maxLuckyValue(){var e=Game.Has("Get lucky")?6300:900;return baseCps()*e}function maxLuckyBank(){return Game.Has("Get lucky")?luckyFrenzyBank():luckyBank()}function maxCookieTime(){return Game.shimmerTypes.golden.maxTime}function gcPs(e){return e/=probabilitySpan("golden",0,.5)/Game.fps,e*=FrozenCookies.simulatedGCPercent}function gcEfficiency(){return gcPs(weightedCookieValue())<=0?Number.MAX_VALUE:divCps(Math.max(0,10*maxLuckyValue()-Game.cookies),gcPs(weightedCookieValue()-weightedCookieValue(!0)))}function delayAmount(){return bestBank(nextChainedPurchase().efficiency).cost}function haveAll(e){return _.every(holidayCookies[e],function(e){return Game.UpgradesById[e].unlocked})}function checkPrices(e){var o=0;if(FrozenCookies.caches.recommendationList.length>0){var a=FrozenCookies.caches.recommendationList.filter(function(o){return o.id!=e.id})[0],n="upgrade"==a.type?unfinishedUpgradePrereqs(a.purchase):null;o=null==(a=null==n||0==n.filter(function(e){return null!=e.cost}).length?a:FrozenCookies.caches.recommendationList.filter(function(e){return n.some(function(o){return o.id==e.id&&o.type==e.type})})[0]).cost?0:a.cost/totalDiscount("building"==a.type)-a.cost}return o}function purchaseEfficiency(e,o,a,n){var t=Number.POSITIVE_INFINITY;return o>0&&(t=FrozenCookies.efficiencyWeight*divCps(e,n)+divCps(e,o)),t}function recommendationList(e){if(e){if(FrozenCookies.caches.recommendationList=addScores(upgradeStats(e).concat(buildingStats(e)).concat(santaStats()).sort(function(e,o){return e.efficiency!=o.efficiency?e.efficiency-o.efficiency:e.delta_cps!=o.delta_cps?o.delta_cps-e.delta_cps:e.cost-o.cost})),M&&3==FrozenCookies.autoSpell&&Game.Objects["Fractal engine"].amount>=399)for(var o=0;o<FrozenCookies.caches.recommendationList.length;o++)14==FrozenCookies.caches.recommendationList[o].id&&FrozenCookies.caches.recommendationList.splice(o,1);if(M&&FrozenCookies.towerLimit&&M.magicM>=FrozenCookies.manaMax)for(o=0;o<FrozenCookies.caches.recommendationList.length;o++)7==FrozenCookies.caches.recommendationList[o].id&&FrozenCookies.caches.recommendationList.splice(o,1);if(FrozenCookies.cursorLimit&&Game.Objects.Cursor.amount>=FrozenCookies.cursorMax)for(o=0;o<FrozenCookies.caches.recommendationList.length;o++)0==FrozenCookies.caches.recommendationList[o].id&&FrozenCookies.caches.recommendationList.splice(o,1);if(FrozenCookies.farmLimit&&Game.Objects.Farm.amount>=FrozenCookies.farmMax)for(o=0;o<FrozenCookies.caches.recommendationList.length;o++)2==FrozenCookies.caches.recommendationList[o].id&&FrozenCookies.caches.recommendationList.splice(o,1);FrozenCookies.pastemode&&FrozenCookies.caches.recommendationList.reverse()}return FrozenCookies.caches.recommendationList}function addScores(e){var o=e.filter(function(e){return e.efficiency<Number.POSITIVE_INFINITY&&e.efficiency>Number.NEGATIVE_INFINITY});if(o.length>0){var a=Math.log(e[0].efficiency),n=Math.log(e[o.length-1].efficiency)-a;e.forEach(function(o,t){if(o.efficiency<Number.POSITIVE_INFINITY&&o.efficiency>Number.NEGATIVE_INFINITY){var i=Math.log(o.efficiency)-a;e[t].efficiencyScore=1-i/n}else e[t].efficiencyScore=0})}else e.forEach(function(o,a){e[a].efficiencyScore=0});return e}function nextPurchase(e){if(e){for(var o=recommendationList(e),a=null,n=null,t=0;t<o.length;t++){if("upgrade"==(n=o[t]).type&&unfinishedUpgradePrereqs(Game.UpgradesById[n.id])){var i=unfinishedUpgradePrereqs(Game.UpgradesById[n.id]);a=o.filter(function(e){return i.some(function(o){return o.id==e.id&&o.type==e.type})})[0]}else a=n;if(a){FrozenCookies.caches.nextPurchase=a,FrozenCookies.caches.nextChainedPurchase=n;break}}null==a&&(FrozenCookies.caches.nextPurchase=defaultPurchase(),FrozenCookies.caches.nextChainedPurchase=defaultPurchase())}return FrozenCookies.caches.nextPurchase}function nextChainedPurchase(e){return nextPurchase(e),FrozenCookies.caches.nextChainedPurchase}function buildingStats(e){if(e){var o=blacklist[FrozenCookies.blacklist].buildings,a=bestBank(0).cost;FrozenCookies.caches.buildings=Game.ObjectsById.map(function(e,n){if(!0===o||_.contains(o,e.id))return null;var t=baseCps(),i=effectiveCps(Math.min(Game.cookies,a)),r=Game.AchievementsById.map(function(e,o){return e.won});buildingToggle(e);var s=baseCps(),c=effectiveCps(a);buildingToggle(e,r);var u=c-i,l=s-t,m=purchaseEfficiency(e.getPrice(),u,l,i);return{id:e.id,efficiency:m,base_delta_cps:l,delta_cps:u,cost:e.getPrice(),purchase:e,type:"building"}}).filter(function(e){return e})}return FrozenCookies.caches.buildings}function upgradeStats(e){if(e){var o=blacklist[FrozenCookies.blacklist].upgrades,a=bestBank(0).cost;FrozenCookies.caches.upgrades=Game.UpgradesById.map(function(e){if(!e.bought){unfinishedUpgradePrereqs(e);if(isUnavailable(e,o))return null;var n=upgradePrereqCost(e),t=baseCps(),i=effectiveCps(Math.min(Game.cookies,a)),r=Game.AchievementsById.map(function(e){return e.won}),s=Game.elderWrath,c=totalDiscount()+totalDiscount(!0),u=upgradeToggle(e),l=baseCps(),m=effectiveCps(a),k=c==totalDiscount()+totalDiscount(!0)?0:checkPrices(e);upgradeToggle(e,r,u),Game.elderWrath=s;var d=m-i,C=l-t,f=e.season&&e.season==seasons[FrozenCookies.defaultSeason]?n/t:k>n?1:purchaseEfficiency(n,d,C,i);return{id:e.id,efficiency:f,base_delta_cps:C,delta_cps:d,cost:n,purchase:e,type:"upgrade"}}}).filter(function(e){return e})}return FrozenCookies.caches.upgrades}function isUnavailable(e,o){var a=!1,n=unfinishedUpgradePrereqs(e);return a=(a=(a=(a=(a=a||!e.unlocked&&!n)||!0===o)||_.contains(o,e.id))||n&&null!=_.find(n,function(e){return"wrinklers"==e.type}))||e.season&&(!haveAll(Game.season)||e.season!=seasons[FrozenCookies.defaultSeason]&&haveAll(e.season)),331==e.id&&(a=!0),333==e.id&&(a=!0),414==e.id&&(a=!0),361==e.id&&(a=!0),452==e.id&&(a=!0),227==e.id&&(a=!0),563==e.id&&(a=!0),a}function santaStats(){return Game.Has("A festive hat")&&Game.santaLevel+1<Game.santaLevels.length?{id:0,efficiency:1/0,base_delta_cps:0,delta_cps:0,cost:cumulativeSantaCost(1),type:"santa",purchase:{id:0,name:"Santa Stage Upgrade ("+Game.santaLevels[(Game.santaLevel+1)%Game.santaLevels.length]+")",buy:buySanta,getCost:function(){return cumulativeSantaCost(1)}}}:[]}function defaultPurchase(){return{id:0,efficiency:1/0,delta_cps:0,base_delta_cps:0,cost:1/0,type:"other",purchase:{id:0,name:"No valid purchases!",buy:function(){},getCost:function(){return 1/0}}}}function totalDiscount(e){var o=1;return e?(Game.Has("Season savings")&&(o*=.99),Game.Has("Santa's dominion")&&(o*=.99),Game.Has("Faberge egg")&&(o*=.99),Game.Has("Divine discount")&&(o*=.99),Game.hasAura("Fierce Hoarder")&&(o*=.98),Game.hasBuff("Everything must go")&&(o*=.95)):(Game.Has("Toy workshop")&&(o*=.95),Game.Has("Five-finger discount")&&(o*=Math.pow(.99,Game.Objects.Cursor.amount/100)),Game.Has("Santa's dominion")&&(o*=.98),Game.Has("Faberge egg")&&(o*=.99),Game.Has("Divine sales")&&(o*=.99),Game.hasAura("Master of the Armory")&&(o*=.98)),o}function cumulativeBuildingCost(e,o,a){return e*totalDiscount(!0)*(Math.pow(Game.priceIncrease,a)-Math.pow(Game.priceIncrease,o))/(Game.priceIncrease-1)}function cumulativeSantaCost(e){var o=0;if(e)if(Game.santaLevel+e<Game.santaLevels.length)for(var a=Game.santaLevel+1;a<=Game.santaLevel+e;a++)o+=Math.pow(a,a);else if(e<Game.santaLevels.length)for(a=Game.santaLevel+1;a<=e;a++)o+=Math.pow(a,a);else o=1/0;else;return o}function cumulativeSantaCost(e){var o=0;if(e)if(Game.santaLevel+e<Game.santaLevels.length)for(var a=Game.santaLevel+1;a<=Game.santaLevel+e;a++)o+=Math.pow(a,a);else if(e<Game.santaLevels.length)for(a=Game.santaLevel+1;a<=e;a++)o+=Math.pow(a,a);else o=1/0;else;return o}function upgradePrereqCost(e,o){var a=e.getPrice();if(e.unlocked)return a;var n=upgradeJson[e.id];return n&&(a+=n.buildings.reduce(function(e,a,n){var t=Game.ObjectsById[n];return a&&o?e+=cumulativeBuildingCost(t.basePrice,0,a):a&&t.amount<a&&(e+=cumulativeBuildingCost(t.basePrice,t.amount,a)),e},0),a+=n.upgrades.reduce(function(a,n){var t=Game.UpgradesById[n];return e.bought&&!o||(a+=upgradePrereqCost(t,o)),a},0),a+=cumulativeSantaCost(n.santa)),a}function unfinishedUpgradePrereqs(e){if(e.unlocked)return null;var o=[],a=upgradeJson[e.id];return a&&(a.buildings.forEach(function(e,a){e&&Game.ObjectsById[a].amount<e&&o.push({type:"building",id:a})}),a.upgrades.forEach(function(e){if(!Game.UpgradesById[e].bought){var a=Game.UpgradesById[e],n=unfinishedUpgradePrereqs(a);a.unlocked?o.push({type:"upgrade",id:e}):n&&n.forEach(function(e){o.some(function(o){return o.id==e.id&&o.type==e.type})||o.push(e)})}}),a.santa&&o.push({type:"santa",id:0}),a.wrinklers&&0==Game.elderWrath&&o.push({type:"wrinklers",id:0})),o.length?o:null}function upgradeToggle(e,o,a){if(o)a.prereqBuildings&&a.prereqBuildings.forEach(function(e){var o=Game.ObjectsById[e.id];o.amount-=e.amount,o.bought-=e.amount,Game.BuildingsOwned-=e.amount}),a.prereqUpgrades&&a.prereqUpgrades.forEach(function(e){upgradeToggle(Game.UpgradesById[e.id],[],e.reverseFunctions)}),e.bought=0,Game.UpgradesOwned-=1,buyFunctionToggle(a.current),Game.AchievementsOwned=0,o.forEach(function(e,o){var a=Game.AchievementsById[o];a.won=e,e&&"shadow"!=a.pool&&(Game.AchievementsOwned+=1)});else{if(a={},!e.unlocked){var n=upgradeJson[e.id];n&&(a.prereqBuildings=[],n.buildings.forEach(function(e,o){var n=Game.ObjectsById[o];if(e&&n.amount<e){var t=e-n.amount;a.prereqBuildings.push({id:o,amount:t}),n.amount+=t,n.bought+=t,Game.BuildingsOwned+=t}}),a.prereqUpgrades=[],n.upgrades.length>0&&n.upgrades.forEach(function(e){var o=Game.UpgradesById[e];o.bought||a.prereqUpgrades.push({id:e,reverseFunctions:upgradeToggle(o)})}))}e.bought=1,Game.UpgradesOwned+=1,a.current=buyFunctionToggle(e)}return Game.recalculateGains=1,Game.CalculateGains(),a}function buildingToggle(e,o){o?(e.amount-=1,e.bought-=1,Game.BuildingsOwned-=1,Game.AchievementsOwned=0,o.forEach(function(e,o){var a=Game.AchievementsById[o];a.won=e,e&&"shadow"!=a.pool&&(Game.AchievementsOwned+=1)})):(e.amount+=1,e.bought+=1,Game.BuildingsOwned+=1),Game.recalculateGains=1,Game.CalculateGains()}function buyFunctionToggle(upgrade){if(upgrade&&452==upgrade.id)return null;if(upgrade&&!upgrade.length){if(!upgrade.buyFunction)return null;var ignoreFunctions=[/Game\.Earn\('.*\)/,/Game\.Lock\('.*'\)/,/Game\.Unlock\(.*\)/,/Game\.Objects\['.*'\]\.drawFunction\(\)/,/Game\.Objects\['.*'\]\.redraw\(\)/,/Game\.SetResearch\('.*'\)/,/Game\.Upgrades\['.*'\]\.basePrice=.*/,/Game\.CollectWrinklers\(\)/,/Game\.RefreshBuildings\(\)/,/Game\.storeToRefresh=1/,/Game\.upgradesToRebuild=1/,/Game\.Popup\(.*\)/,/Game\.Notify\(.*\)/,/var\s+.+\s*=.+/,/Game\.computeSeasonPrices\(\)/,/Game\.seasonPopup\.reset\(\)/,/\S/],buyFunctions=upgrade.buyFunction.toString().replace(/[\n\r\s]+/g," ").replace(/function\s*\(\)\s*{(.+)\s*}/,"$1").replace(/for\s*\(.+\)\s*\{.+\}/,"").replace(/if\s*\(this\.season\)\s*Game\.season=this\.season\;/,'Game.season="'+upgrade.season+'";').replace(/if\s*\(.+\)\s*[^{}]*?\;/,"").replace(/if\s*\(.+\)\s*\{.+\}/,"").replace(/else\s+\(.+\)\s*\;/,"").replace("++","+=1").replace("--","-=1").split(";").map(function(e){return e.trim()}).filter(function(e){return ignoreFunctions.forEach(function(o){e=e.replace(o,"")}),""!=e});if(0==buyFunctions.length)return null;var reversedFunctions=buyFunctions.map(function(a){var reversed="",achievementMatch=/Game\.Win\('(.*)'\)/.exec(a);if(a.indexOf("+=")>-1)reversed=a.replace("+=","-=");else if(a.indexOf("-=")>-1)reversed=a.replace("-=","+=");else if(achievementMatch&&0==Game.Achievements[achievementMatch[1]].won)reversed="Game.Achievements['"+achievementMatch[1]+"'].won=0";else if(a.indexOf("=")>-1){var expression=a.split("="),expressionResult=eval(expression[0]),isString=_.isString(expressionResult);reversed=expression[0]+"="+(isString?"'":"")+expressionResult+(isString?"'":"")}return reversed});return buyFunctions.forEach(function(f){eval(f)}),reversedFunctions}return upgrade&&upgrade.length&&upgrade.forEach(function(f){eval(f)}),null}function buySanta(){Game.specialTab="santa",Game.UpgradeSanta(),Game.santaLevel+1>=Game.santaLevels.length&&Game.ToggleSpecialMenu()}function statSpeed(){var e=0;switch(FrozenCookies.trackStats){case 1:e=6e4;break;case 2:e=18e5;break;case 3:e=36e5;break;case 4:e=864e5}return e}function saveStats(e){FrozenCookies.trackedStats.push({time:Date.now()-Game.startDate,baseCps:baseCps(),effectiveCps:effectiveCps(),hc:Game.HowMuchPrestige(Game.cookiesEarned+Game.cookiesReset+wrinklerValue())}),$("#statGraphContainer").length>0&&!$("#statGraphContainer").is(":hidden")&&!e&&viewStatGraphs()}function viewStatGraphs(){saveStats(!0);var e=$("#statGraphContainer").length?$("#statGraphContainer"):$("<div>").attr("id","statGraphContainer").html($("<div>").attr("id","statGraphs")).appendTo("body").dialog({modal:!0,title:"Frozen Cookies Tracked Stats",width:.8*$(window).width(),height:.8*$(window).height()});if(e.is(":hidden")&&e.dialog(),FrozenCookies.trackedStats.length>0&&Date.now()-FrozenCookies.lastGraphDraw>1e3){FrozenCookies.lastGraphDraw=Date.now(),$("#statGraphs").empty();$.jqplot("statGraphs",transpose(FrozenCookies.trackedStats.map(function(e){return[[e.time/1e3,e.baseCps],[e.time/1e3,e.effectiveCps],[e.time/1e3,e.hc]]})),{legend:{show:!0},height:e.height()-50,axes:{xaxis:{tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{angle:-30,fontSize:"10pt",showGridline:!1,formatter:function(e,o){return timeDisplay(o)}}},yaxis:{padMin:0,renderer:$.jqplot.LogAxisRenderer,tickDistribution:"even",tickOptions:{formatter:function(e,o){return Beautify(o)}}},y2axis:{padMin:0,tickOptions:{showGridline:!1,formatter:function(e,o){return Beautify(o)}}}},highlighter:{show:!0,sizeAdjust:15},series:[{label:"Base CPS"},{label:"Effective CPS"},{label:"Earned HC",yaxis:"y2axis"}]})}}function updateCaches(){var e,o,a,n,t,i=0;do{e=nextPurchase(FrozenCookies.recalculateCaches),FrozenCookies.recalculateCaches=!1,o=bestBank(0),a=bestBank(e.efficiency),n=gcPs(cookieValue(o.cost)),t=Game.UpgradesInStore.length,FrozenCookies.safeGainsCalc(),FrozenCookies.lastCPS!=FrozenCookies.calculatedCps&&(FrozenCookies.recalculateCaches=!0,FrozenCookies.lastCPS=FrozenCookies.calculatedCps),FrozenCookies.currentBank.cost!=o.cost&&(FrozenCookies.recalculateCaches=!0,FrozenCookies.currentBank=o),FrozenCookies.targetBank.cost!=a.cost&&(FrozenCookies.recalculateCaches=!0,FrozenCookies.targetBank=a),FrozenCookies.lastCookieCPS!=n&&(FrozenCookies.recalculateCaches=!0,FrozenCookies.lastCookieCPS=n),FrozenCookies.lastUpgradeCount!=t&&(FrozenCookies.recalculateCaches=!0,FrozenCookies.lastUpgradeCount=t),i+=1}while(FrozenCookies.recalculateCaches&&i<10)}function doTimeTravel(){if(FrozenCookies.timeTravelMethod){if(timeTravelMethod%2==1&&effectiveCps()){1===timeTravelMethod||timeTravelMethod}}else FrozenCookies.timeTravelAmount=0}function fcWin(e){if("string"==typeof e){if(Game.Achievements[e]&&0==Game.Achievements[e].won){Game.Achievements[e].shortName?Game.Achievements[e].shortName:Game.Achievements[e].name;Game.Achievements[e].won=1,FrozenCookies.disabledPopups||logEvent("Achievement","Achievement unlocked :<br>"+Game.Achievements[e].name+"<br> ",!0),"shadow"!=Game.Achievements[e].pool&&Game.AchievementsOwned++,Game.recalculateGains=1}}else{logEvent("fcWin Else condition");for(var o in e)Game.Win(e[o])}}function logEvent(e,o,a){var n="["+timeDisplay((Date.now()-Game.startDate)/1e3)+"]"+" "+e+": "+o;FrozenCookies.logging&&console.log(n),a&&Game.Popup(o)}function inRect(e,o,a){var n=e+Math.sin(-a.r)*-(a.h/2-a.o),t=o+Math.cos(-a.r)*-(a.h/2-a.o),i=Math.sqrt(n*n+t*t),r=Math.atan2(t,n)-a.r,s=Math.cos(r)*i,c=Math.sin(r)*i;return s>-.5*a.w&&s<.5*a.w&&c>-.5*a.h&&c<.5*a.h}function transpose(e){return Object.keys(e[0]).map(function(o){return e.map(function(e){return e[o]})})}function smartTrackingStats(e){saveStats(),6==FrozenCookies.trackStats&&(e/=0==FrozenCookies.delayPurchaseCount?1/1.5:e>FrozenCookies.minDelay?2:1,FrozenCookies.smartTrackingBot=setTimeout(function(){smartTrackingStats(e)},e),FrozenCookies.delayPurchaseCount=0)}function shouldClickGC(){for(var e in Game.shimmers)if("golden"==Game.shimmers[e].type)return Game.shimmers[e].life>0&&FrozenCookies.autoGC}function liveWrinklers(){return _.select(Game.wrinklers,function(e){return e.sucked>.5&&e.phase>0}).sort(function(e,o){return e.sucked<o.sucked})}function wrinklerMod(e){return 1.1*e*e*.05*(Game.Has("Wrinklerspawn")?1.05:1)+(1-.05*e)}function popValue(e){var o=1.1;Game.Has("Sacrilegious corruption")&&(o*=1.05),1==e.type&&(o*=3);var a=e.sucked*o;return Game.Has("Wrinklerspawn")&&(a*=1.05),a}function shouldPopWrinklers(){var e=[],o=liveWrinklers();if(o.length>0)if("halloween"!=Game.season&&"easter"!=Game.season||haveAll(Game.season)){var a=delayAmount(),n=0==FrozenCookies.shinyPop?Game.wrinklers.filter(v>=v.type==0):Game.wrinklers,t=nextPurchase().cost+a-Game.cookies,i=nextPurchase().delta_cps,r=n.sort(function(e,o){return e.sucked<o.sucked}).reduce(function(e,n){var r=o.length-(e.ids.length+1);return e.total<t&&effectiveCps(a,Game.elderWrath,r)+i>effectiveCps()&&(e.ids.push(n.id),e.total+=popValue(n)),e},{total:0,ids:[]});e=r.total>t?r.ids:e}else e=o.map(function(e){return e.id});return e}function autoFrenzyClick(){hasClickBuff()&&!FrozenCookies.autoFrenzyBot?(FrozenCookies.autoclickBot&&(clearInterval(FrozenCookies.autoclickBot),FrozenCookies.autoclickBot=0),FrozenCookies.autoFrenzyBot=setInterval(fcClickCookie,1e3/FrozenCookies.frenzyClickSpeed)):!hasClickBuff()&&FrozenCookies.autoFrenzyBot&&(clearInterval(FrozenCookies.autoFrenzyBot),FrozenCookies.autoFrenzyBot=0,FrozenCookies.autoClick&&FrozenCookies.cookieClickSpeed&&(FrozenCookies.autoclickBot=setInterval(fcClickCookie,1e3/FrozenCookies.cookieClickSpeed)))}function autoGSBuy(){hasClickBuff()?Game.Upgrades["Golden switch [off]"].unlocked&&!Game.Upgrades["Golden switch [off]"].bought&&Game.Upgrades["Golden switch [off]"].buy():cpsBonus()<=1&&Game.Upgrades["Golden switch [on]"].unlocked&&!Game.Upgrades["Golden switch [on]"].bought&&(Game.CalculateGains(),Game.Upgrades["Golden switch [on]"].buy())}function autoGodzamokAction(){if(T&&Game.hasGod("ruin")&&Game.Objects.Cursor.amount>10&&Game.Objects.Farm.amount>10&&(!Game.hasBuff("Devastation")||1==FrozenCookies.autoGodzamok||3==FrozenCookies.autoGodzamok)&&hasClickBuff()){var e=Game.Objects.Cursor.amount,o=Game.Objects.Farm.amount-1;Game.Objects.Cursor.sell(e),Game.Objects.Farm.sell(o),FrozenCookies.autoGodzamok>1&&(Game.Objects.Cursor.buy(e),Game.Objects.Farm.buy(o))}}function goldenCookieLife(){for(var e in Game.shimmers)if("golden"==Game.shimmers[e].type)return Game.shimmers[e].life;return null}function reindeerLife(){for(var e in Game.shimmers)if("reindeer"==Game.shimmers[e].type)return Game.shimmers[e].life;return null}function fcClickCookie(){Game.OnAscend||Game.AscendTimer||Game.specialTabHovered||Game.ClickCookie()}function autoCookie(){if(FrozenCookies.processing||Game.OnAscend||Game.AscendTimer)!FrozenCookies.processing&&FrozenCookies.frequency&&(FrozenCookies.cookieBot=setTimeout(autoCookie,FrozenCookies.frequency));else{FrozenCookies.processing=!0;var e=Game.HowMuchPrestige(Game.cookiesEarned+Game.cookiesReset+wrinklerValue());if(Math.floor(FrozenCookies.lastHCAmount)<Math.floor(e)){var o=e-FrozenCookies.lastHCAmount;FrozenCookies.lastHCAmount=e,FrozenCookies.prevLastHCTime=FrozenCookies.lastHCTime,FrozenCookies.lastHCTime=Date.now();var a=3600*(FrozenCookies.lastHCAmount-Game.heavenlyChips)/((FrozenCookies.lastHCTime-Game.startDate)/1e3);Game.heavenlyChips<e-o&&a>FrozenCookies.maxHCPercent&&(FrozenCookies.maxHCPercent=a),FrozenCookies.hc_gain+=o,updateLocalStorage()}updateCaches();var n=nextPurchase(),t=delayAmount();if(FrozenCookies.timeTravelAmount&&doTimeTravel(),FrozenCookies.autoSL){var i=Game.lumpT,r=Game.lumpRipeAge;Date.now()-i>=r&&Game.clickLump()}if(2==FrozenCookies.autoSL&&autoRigidel(),1==FrozenCookies.autoWrinkler){var s=0,c=shouldPopWrinklers();_.filter(Game.wrinklers,function(e){return _.contains(c,e.id)}).forEach(function(e){e.hp=0,s+=1}),s>0&&logEvent("Wrinkler","Popped "+s+" wrinklers.")}if(2==FrozenCookies.autoWrinkler){s=0;(c=Game.wrinklers).forEach(function(e){1==e.close&&(e.hp=0,s+=1)}),s>0&&logEvent("Wrinkler","Popped "+s+" wrinklers.")}var u=!1;if(0!=FrozenCookies.autoBulk&&(1==FrozenCookies.autoBulk&&document.getElementById("storeBulk10").click(),2==FrozenCookies.autoBulk&&document.getElementById("storeBulk100").click()),FrozenCookies.autoBuy&&(Game.cookies>=t+n.cost||"Elder Pledge"==n.purchase.name)&&(FrozenCookies.pastemode||isFinite(nextChainedPurchase().efficiency))&&(n.time=Date.now()-Game.startDate,n.purchase.clickFunction=null,disabledPopups=!1,n.purchase.buy(),FrozenCookies.autobuyCount+=1,5==FrozenCookies.trackStats&&"upgrade"==n.type?saveStats():6==FrozenCookies.trackStats&&(FrozenCookies.delayPurchaseCount+=1),logEvent("Store","Autobought "+n.purchase.name+" for "+Beautify(n.cost)+", resulting in "+Beautify(n.delta_cps)+" CPS."),disabledPopups=!0,FrozenCookies.autobuyCount>=10&&(Game.Draw(),FrozenCookies.autobuyCount=0),FrozenCookies.recalculateCaches=!0,FrozenCookies.processing=!1,u=!0),FrozenCookies.autoAscend&&!Game.OnAscend&&!Game.AscendTimer){var l=Game.prestige,m=Game.HowMuchPrestige(Game.cookiesReset+Game.cookiesEarned+wrinklerValue()+chocolateValue()),k=FrozenCookies.HCAscendAmount;m-l>=k&&k>0&&(Game.ClosePrompt(),Game.Ascend(1),setTimeout(function(){Game.ClosePrompt(),Game.Reincarnate(1)},1e4))}var d=["24","25","30","48","50","60","72","90","100","120","144","200","240","300"];if(parseInt(d[FrozenCookies.fpsModifier])!=Game.fps&&(Game.fps=parseInt(d[FrozenCookies.fpsModifier])),goldenCookieLife()&&FrozenCookies.autoGC)for(var C in Game.shimmers)"golden"==Game.shimmers[C].type&&Game.shimmers[C].pop();if(reindeerLife()>0&&FrozenCookies.autoReindeer)for(var C in Game.shimmers)"reindeer"==Game.shimmers[C].type&&Game.shimmers[C].pop();FrozenCookies.autoBlacklistOff&&autoBlacklistOff();var f=(Game.hasBuff("Frenzy")?Game.buffs.Frenzy.multCpS:1)*clickBuffBonus();f!=FrozenCookies.last_gc_state&&(1!=FrozenCookies.last_gc_state&&1==f?(logEvent("GC","Frenzy ended, cookie production x1"),FrozenCookies.hc_gain&&(logEvent("HC","Won "+FrozenCookies.hc_gain+" heavenly chips during Frenzy. Rate: "+1e3*FrozenCookies.hc_gain/(Date.now()-FrozenCookies.hc_gain_time)+" HC/s."),FrozenCookies.hc_gain_time=Date.now(),FrozenCookies.hc_gain=0)):(1!=FrozenCookies.last_gc_state?logEvent("GC","Previous Frenzy x"+FrozenCookies.last_gc_state+"interrupted."):FrozenCookies.hc_gain&&(logEvent("HC","Won "+FrozenCookies.hc_gain+" heavenly chips outside of Frenzy. Rate: "+1e3*FrozenCookies.hc_gain/(Date.now()-FrozenCookies.hc_gain_time)+" HC/s."),FrozenCookies.hc_gain_time=Date.now(),FrozenCookies.hc_gain=0),logEvent("GC","Starting "+(hasClickBuff()?"Clicking ":"")+"Frenzy x"+f)),null==FrozenCookies.frenzyTimes[FrozenCookies.last_gc_state]&&(FrozenCookies.frenzyTimes[FrozenCookies.last_gc_state]=0),FrozenCookies.frenzyTimes[FrozenCookies.last_gc_state]+=Date.now()-FrozenCookies.last_gc_time,FrozenCookies.last_gc_state=f,FrozenCookies.last_gc_time=Date.now(),updateLocalStorage()),FrozenCookies.processing=!1,FrozenCookies.frequency&&(FrozenCookies.cookieBot=setTimeout(autoCookie,u?0:FrozenCookies.frequency))}}function FCStart(){FrozenCookies.cookieBot&&(clearInterval(FrozenCookies.cookieBot),FrozenCookies.cookieBot=0),FrozenCookies.autoclickBot&&(clearInterval(FrozenCookies.autoclickBot),FrozenCookies.autoclickBot=0),FrozenCookies.statBot&&(clearInterval(FrozenCookies.statBot),FrozenCookies.statBot=0),FrozenCookies.autoGSBot&&(clearInterval(FrozenCookies.autoGSBot),FrozenCookies.autoGSBot=0),FrozenCookies.autoGodzamokBot&&(clearInterval(FrozenCookies.autoGodzamokBot),FrozenCookies.autoGodzamokBot=0),FrozenCookies.frequency&&(FrozenCookies.cookieBot=setTimeout(autoCookie,FrozenCookies.frequency)),FrozenCookies.autoClick&&FrozenCookies.cookieClickSpeed&&(FrozenCookies.autoclickBot=setInterval(fcClickCookie,1e3/FrozenCookies.cookieClickSpeed)),FrozenCookies.autoFrenzy&&FrozenCookies.frenzyClickSpeed&&(FrozenCookies.frenzyClickBot=setInterval(autoFrenzyClick,FrozenCookies.frequency)),FrozenCookies.autoGS&&(FrozenCookies.autoGSBot=setInterval(autoGSBuy,FrozenCookies.frequency)),FrozenCookies.autoGodzamok&&(FrozenCookies.autoGodzamokBot=setInterval(autoGodzamokAction,FrozenCookies.frequency)),FrozenCookies.autoSpell&&setInterval(autoCast,10*FrozenCookies.frequency),statSpeed(FrozenCookies.trackStats)>0?FrozenCookies.statBot=setInterval(saveStats,statSpeed(FrozenCookies.trackStats)):6!=FrozenCookies.trackStats||FrozenCookies.smartTrackingBot||(FrozenCookies.smartTrackingBot=setTimeout(function(){smartTrackingStats(8*FrozenCookies.minDelay)},FrozenCookies.minDelay)),FCMenu()}
